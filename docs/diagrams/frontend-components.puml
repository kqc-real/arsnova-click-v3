@startuml frontend-components
' ============================================================================
' arsnova.click V3 â€“ Frontend-Komponentendiagramm (Angular 19, Stand: 2026-02-19)
' Standalone Components Â· Signals Â· Tailwind CSS Â· tRPC Â· Yjs
' 56 Storys Â· 9 Epics
' ============================================================================

!theme plain
skinparam shadowing false
skinparam component {
  BackgroundColor #FEFEFE
  BorderColor #333333
}

title arsnova.click V3 â€” Frontend-Architektur (Angular 19)\nStandalone Components Â· Signals Â· Tailwind CSS

' â”€â”€â”€ Root â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Root" #e0e0e0 {
  [AppComponent] as app
  [app.routes.ts] as routes
  [app.config.ts] as config
}

' â”€â”€â”€ Shared Components â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Shared Components" #e8f5e9 {
  [HeaderComponent] as header
  [FooterComponent] as footer
  [ThemeSwitcherComponent\n(Light/Dark/System)] as theme
  [LanguageSwitcherComponent\n(de/en/fr/it/es)] as lang
  [CountdownComponent\n(Kreis + Puls letzte 5s)] as countdown
  [MarkdownKatexComponent\n(marked + katex)] as mdkatex
  [ConfirmDialogComponent] as confirm
}

' â”€â”€â”€ Route: Home â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Home  /" #e3f2fd {
  [HomePageComponent] as home
  [ServerStatusWidget\n(Story 0.4: healthy/busy/overloaded)] as status
  [JoinInputComponent\n(6-stelliger Code)] as join
}

' â”€â”€â”€ Route: Quiz-Verwaltung â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Quiz-Verwaltung  /quiz" #e8f5e9 {
  [QuizListComponent\n(KontextmenÃ¼: â‹®)] as quizlist
  [QuizEditorComponent\n(Name, Beschreibung, Config)] as editor
  [QuizConfigComponent\n(Toggles + bonusTokenCount)] as quizconfig
  [QuizPresetSelector\n(ðŸŽ® Spielerisch / ðŸŽ“ SeriÃ¶s)] as presets
  [QuestionEditorComponent\n(MC/SC/Freitext/Rating/Survey)] as questionedit
  [AnswerEditorComponent\n(isCorrect-Toggle)] as answeredit
  [ScFormatDropdown\n(Ja/Nein, Wahr/Falsch, A/B/C/D)] as scformat
  [RatingConfigComponent\n(Min/Max/Labels)] as ratingconfig
  [ImportExportComponent\n(JSON, Zod-Validierung)] as importexport
  [QuizPreviewComponent\n(Story 1.13: Vollbild-Vorschau)] as preview
  [PreviewHotkeyHandler\n(â†’â†NP Home End 1-9 E Esc)] as hotkeys
  [PreviewInlineEditor\n(Klick â†’ Inline-Edit)] as inlineedit
  [ValidationOverlay\n(âš ï¸ Fehler + âœ… Bereit)] as validation
}

note right of scformat
  **Story 1.12:** SC_FORMAT_PRESETS
  YES_NO, YES_NO_MAYBE,
  YES_NO_DONT_KNOW,
  TRUE_FALSE, ABCD
  Rein clientseitig, i18n-lokalisiert.
end note

note right of preview
  **Story 1.13:** Quiz-Preview-Modus
  Hotkeys: â†’/N â†/P Home End 1-9 E Esc
  Swipe-Navigation auf Mobile
  Inline-Schnellkorrektur â†’ Yjs-Sync
  Validierungs-Overlay am unteren Rand
end note

' â”€â”€â”€ Route: Session-Steuerung (Dozent) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Session-Steuerung (Dozent)  /session/:code" #fff3e0 {
  [LobbyComponent\n(Teilnehmer-Liste, Counter)] as lobby
  [QuizControlComponent\n(NÃ¤chste Frage / Countdown / Ergebnis)] as control
  [QaModeratorComponent\n(Pin/Archiv/LÃ¶schen/Moderation)] as qamoderator
  [BonusTokenListComponent\n(Story 4.6: Tabelle + CSV-Export)] as tokenlist
}

note right of tokenlist
  **Story 4.6:** session.getBonusTokens()
  Token, Pseudonym, Score, Rang, Datum
  CSV-Download clientseitig.
end note

' â”€â”€â”€ Route: Beamer-Ansicht â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Beamer  /session/:code/present" #fff9c4 {
  [BeamerViewComponent\n(Vollbild, groÃŸe Schrift)] as beamer
  [ResultChartComponent\n(Balken animiert, 300ms)] as chart
  [WordcloudComponent\n(Freitext â‰¥ 10)] as wordcloud
  [RatingHistogramComponent\n(Verteilung + Ã˜ + Ïƒ)] as histogram
  [LeaderboardComponent\n(Top 5, Team-Leaderboard)] as leaderboard
  [EmojiOverlayComponent\n(aufsteigende Blasen)] as emojioverlay
  [QrCodeComponent] as qrcode
}

' â”€â”€â”€ Route: Student-Ansicht â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Student  /session/:code/vote" #e3f2fd {
  [NicknameSelectComponent\n(Themes Ã— 50+ Namen)] as nickname
  [VotingViewComponent\n(Signal-basiert)] as voting
  [AnswerButtonsComponent\n(â–³â—‹â–¡â—‡ Farb+Form-Codierung)] as buttons
  [McToggleButtonsComponent\n(Mehrfachauswahl + Absenden)] as mctoggle
  [RatingScaleComponent\n(horizontal, 1 Tap)] as ratingscale
  [FreetextInputComponent\n(Platzhalter + Absenden)] as freetext
  [ScorecardComponent\n(Bottom-Sheet Overlay)] as scorecard
  [BonusTokenDisplay\n(Story 4.6: Token kopieren)] as tokendisplay
  [MotivationMessageComponent\n(kontextbezogen, i18n)] as motivation
  [EmojiBarComponent\n(ðŸ‘ ðŸŽ‰ ðŸ˜® ðŸ˜‚ ðŸ˜¢)] as emojibar
  [QaStudentComponent\n(Frage + Upvote-Toggle)] as qastudent
}

note right of tokendisplay
  **Story 4.6:** "ðŸŽ“ Dein Bonus-Token: BNS-A3F7-K2M9"
  Kopier-Button â†’ navigator.clipboard.writeText
  Nur fÃ¼r Top-X sichtbar (onPersonalResult).
end note

note left of buttons
  **Story 3.3b:** Vollbreite, gestapelt.
  Thumb Zone (unteres Drittel).
  48Ã—48px Touch-Targets. Debounce 300ms.
  Vibration API. Optimistisches UI-Update.
  Beamer: 2Ã—2-Grid (â‰¤4) oder Liste (â‰¥5).
end note

' â”€â”€â”€ Route: Legal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Legal  /legal" #f3e5f5 {
  [ImprintComponent\n(Markdown, TMG)] as imprint
  [PrivacyComponent\n(Markdown, DSGVO Art. 6)] as privacy
}

' â”€â”€â”€ Services â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

package "Services (Injectable)" #fce4ec {
  [trpcClient\n(httpBatchLink + wsLink)] as trpc
  [YjsService\n(IndexedDB + y-websocket)] as yjs
  [ThemeService\n(Signal: light/dark/system)] as themesvc
  [I18nService\n(de/en/fr/it/es)] as i18nsvc
  [AudioService\n(Web Audio API)] as audiosvc
  [MotivationService\n(clientseitige Regelengine)] as motivsvc
  [ClipboardService\n(navigator.clipboard)] as clipsvc
}

' â”€â”€â”€ Externe Systeme â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

cloud "Backend (tRPC)" as backend
database "IndexedDB\n(Yjs CRDT)" as idb
cloud "WebSocket\n(tRPC Subscriptions)" as ws

' â”€â”€â”€ Verbindungen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

app --> routes
app --> header
app --> footer
header --> theme
header --> lang

home --> status
home --> join

quizlist --> editor
editor --> quizconfig
editor --> questionedit
editor --> importexport
editor --> preview
quizconfig --> presets
questionedit --> answeredit
questionedit --> ratingconfig
questionedit --> scformat
questionedit --> mdkatex
preview --> hotkeys
preview --> inlineedit
preview --> validation
preview --> mdkatex

lobby --> control
control --> beamer
control --> tokenlist

beamer --> chart
beamer --> wordcloud
beamer --> histogram
beamer --> leaderboard
beamer --> emojioverlay
beamer --> qrcode
beamer --> countdown

voting --> buttons
voting --> mctoggle
voting --> ratingscale
voting --> freetext
voting --> countdown
voting --> scorecard
scorecard --> tokendisplay
scorecard --> motivation
voting --> emojibar

trpc --> backend
trpc --> ws
yjs --> idb
audiosvc --> beamer
clipsvc --> tokendisplay

note bottom of trpc
  **tRPC-Links:**
  httpBatchLink â†’ Queries & Mutations
  wsLink â†’ Subscriptions (Echtzeit)
  Ende-zu-Ende typsicher mit Zod.
end note

note bottom of yjs
  **Local-First (ADR-0004):**
  Kein Account nÃ¶tig.
  Quiz-Daten â†’ IndexedDB via Yjs.
  Optional: y-websocket Multi-Device-Sync.
end note

@enduml
